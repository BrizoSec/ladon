# =============================================================================
# LADON Collection Service - Environment Variables Example
# =============================================================================
#
# This file demonstrates all environment variables for the Collection Service.
# Copy this to .env and update with your actual values.
#
# Usage:
#   1. Copy: cp .env.example .env
#   2. Update with your credentials
#   3. Load: source .env (or use docker-compose)
#
# Priority: Environment variables override config.yaml values
# =============================================================================

# -----------------------------------------------------------------------------
# Service Configuration
# -----------------------------------------------------------------------------
COLLECTION_ENVIRONMENT=production  # development, staging, production
COLLECTION_LOG_LEVEL=INFO
COLLECTION_MAX_CONCURRENT_COLLECTORS=10
COLLECTION_HEALTH_CHECK_INTERVAL_SECONDS=60

# Storage Service (for watermark persistence)
COLLECTION_STORAGE_SERVICE_URL=http://storage-service:8080

# Configuration file path (optional - use env vars OR config file)
COLLECTION_CONFIG_FILE=/app/config/config.yaml

# -----------------------------------------------------------------------------
# Pub/Sub Configuration
# -----------------------------------------------------------------------------
PUBSUB_PROJECT_ID=ladon-production
PUBSUB_RAW_IOC_EVENTS_TOPIC=raw-ioc-events
PUBSUB_RAW_ACTIVITY_EVENTS_TOPIC=raw-activity-events
PUBSUB_MAX_MESSAGES_PER_BATCH=1000
PUBSUB_MAX_BATCH_SIZE_BYTES=10000000
PUBSUB_TIMEOUT_SECONDS=10.0

# Google Cloud credentials (if not using workload identity)
GOOGLE_APPLICATION_CREDENTIALS=/secrets/gcp-service-account.json

# -----------------------------------------------------------------------------
# AlienVault OTX Configuration
# -----------------------------------------------------------------------------
# Get your API key from: https://otx.alienvault.com/api
ALIENVAULT_API_KEY=your_alienvault_otx_api_key_here
ALIENVAULT_API_ENDPOINT=https://otx.alienvault.com/api/v1
ALIENVAULT_COLLECTION_INTERVAL_MINUTES=30
ALIENVAULT_PULSES_LIMIT=100

# -----------------------------------------------------------------------------
# abuse.ch Configuration
# -----------------------------------------------------------------------------
# Optional API key (increases rate limits)
# Request from: https://threatfox.abuse.ch/
ABUSECH_API_KEY=  # Leave empty for anonymous access
ABUSECH_THREATFOX_URL=https://threatfox-api.abuse.ch/api/v1/
ABUSECH_URLHAUS_URL=https://urlhaus-api.abuse.ch/v1/
ABUSECH_MALWARE_BAZAAR_URL=https://mb-api.abuse.ch/api/v1/
ABUSECH_COLLECTION_INTERVAL_MINUTES=15

# -----------------------------------------------------------------------------
# MISP Configuration
# -----------------------------------------------------------------------------
# Enterprise threat intelligence platform
# Requires self-hosted or managed MISP instance
MISP_URL=https://misp.your-company.com
MISP_API_KEY=your_misp_api_key_here
MISP_VERIFY_SSL=true
MISP_COLLECTION_INTERVAL_MINUTES=30
MISP_PUBLISHED_ONLY=true
MISP_TO_IDS_ONLY=true

# -----------------------------------------------------------------------------
# Trino Configuration (Proxy Logs)
# -----------------------------------------------------------------------------
TRINO_PROXY_HOST=trino.data-platform.your-company.com
TRINO_PROXY_PORT=8080
TRINO_PROXY_CATALOG=security_logs
TRINO_PROXY_SCHEMA=proxy
TRINO_PROXY_TABLE=http_requests
TRINO_PROXY_USER=ladon_service
TRINO_PROXY_TIMESTAMP_COLUMN=request_timestamp
TRINO_PROXY_COLLECTION_INTERVAL_MINUTES=3
TRINO_PROXY_BATCH_SIZE=100000

# Optional: Trino authentication
TRINO_PROXY_PASSWORD=
TRINO_PROXY_HTTP_SCHEME=https

# -----------------------------------------------------------------------------
# Trino Configuration (DNS Logs)
# -----------------------------------------------------------------------------
TRINO_DNS_HOST=trino.data-platform.your-company.com
TRINO_DNS_PORT=8080
TRINO_DNS_CATALOG=security_logs
TRINO_DNS_SCHEMA=dns
TRINO_DNS_TABLE=dns_queries
TRINO_DNS_USER=ladon_service
TRINO_DNS_TIMESTAMP_COLUMN=query_timestamp
TRINO_DNS_COLLECTION_INTERVAL_MINUTES=3
TRINO_DNS_BATCH_SIZE=150000

# -----------------------------------------------------------------------------
# BigQuery Configuration (Sinkhole Logs)
# -----------------------------------------------------------------------------
BIGQUERY_SINKHOLE_PROJECT_ID=your-gcp-project
BIGQUERY_SINKHOLE_DATASET=security_logs
BIGQUERY_SINKHOLE_TABLE=sinkhole_queries
BIGQUERY_SINKHOLE_TIMESTAMP_COLUMN=timestamp
BIGQUERY_SINKHOLE_PARTITION_FIELD=timestamp
BIGQUERY_SINKHOLE_COLLECTION_INTERVAL_MINUTES=3
BIGQUERY_SINKHOLE_BATCH_SIZE=10000

# -----------------------------------------------------------------------------
# BigQuery Configuration (MDE Alerts)
# -----------------------------------------------------------------------------
BIGQUERY_MDE_PROJECT_ID=your-gcp-project
BIGQUERY_MDE_DATASET=endpoint_security
BIGQUERY_MDE_TABLE=mde_alerts
BIGQUERY_MDE_TIMESTAMP_COLUMN=alert_time
BIGQUERY_MDE_PARTITION_FIELD=alert_time
BIGQUERY_MDE_COLLECTION_INTERVAL_MINUTES=5
BIGQUERY_MDE_BATCH_SIZE=5000

# Notes: Never commit .env to version control!
